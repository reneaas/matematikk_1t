# Oppgaver: Momentan vekstfart


:::::::::::::::{admonition} Oppsummering
---
class: summary
---
::::::::::::::{tab-set}
:::::::::::::{tab-item} Momentan vekstfart
Den momentane vekstfarten til en andregradsfunksjon $f$ i et punkt $x$ er gitt ved 

$$
f'(x) = \dfrac{f(x + 1) - f(x - 1)}{2}
$$


:::::::::::::

:::::::::::::{tab-item} Tangenter
En tangent er en rett linje som går gjennom et punkt $(x_1, f(x_1))$ på grafen til en funksjon $f$ og har samme stigningstall som den momentane vekstfarten $f'(x_1)$ i punktet.

Likningen for en tangent bestemmer vi med ettpunktsformelen

$$
y - y_1 = a(x - x_1)
$$

der $a = f'(x_1)$.
:::::::::::::
::::::::::::::

:::::::::::::::

---

:::::::::::::::{admonition} Oppgave 1
---
class: problem-level-1
---
::::::::::::::{tab-set}
---
class: tabs-parts
---
:::::::::::::{tab-item} a
En andregradsfunksjon $f$ er gitt ved


$$
f(x) = x^2 - 2x + 3.
$$


Bestem $f'(1)$.


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
f'(1) = 0.
$$
:::
:::::::::::::


:::::::::::::{tab-item} b
En andregradsfunksjon $g$ er gitt ved

$$
g(x) = (x - 1)(x + 2).
$$


Bestem $g'(0)$.

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
g'(0) = 1.
$$
:::
:::::::::::::


:::::::::::::{tab-item} c
En andregradsfunksjon $h$ er gitt ved


$$
h(x) = (x - 1)^2 - 4. 
$$


Bestem $h'(-1)$.

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
h'(-1) = -4.
$$
:::
:::::::::::::

:::::::::::::{tab-item} d
En andregradsfunksjon $p$ er gitt ved


$$
p(x) = (x - 2)^2 + 1.
$$


Bestem $p'(2)$.


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
p'(2) = 0.
$$
:::
:::::::::::::

::::::::::::::
:::::::::::::::

---


:::::::::::::::{admonition} Oppgave 2
---
class: problem-level-1
---

::::::::::::::{tab-set}
---
class: tabs-parts
---
:::::::::::::{tab-item} a

I {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-a` vises grafen til en andregradsfunksjon $f$ og en tangent i punktet $(1, f(1))$. 

Bruk {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-a` til å bestemme $f'(1)$.

:::{figure} ./figurer/oppgaver/oppgave_2/a.svg
---
name: fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-a
width: 80%
class: no-click
---
viser grafen til en andregradsfunksjon $f$ og en tangent som går gjennom $(1, f(1))$.
:::

::::{admonition} Fasit
---
class: answer, dropdown
---
$$
f'(1) = 4.
$$
::::
:::::::::::::


:::::::::::::{tab-item} b

I {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-b` vises grafen til en andregradsfunksjon $g$ og en tangent i punktet $(-1, g(-1))$. 

Bruk {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-b` til å bestemme $g'(-1)$.

:::{figure} ./figurer/oppgaver/oppgave_2/b.svg
---
name: fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-b
width: 80%
class: no-click
---
viser grafen til en andregradsfunksjon $g$ og en tangent som går gjennom $(-1, g(-1))$.
:::

::::{admonition} Fasit
---
class: answer, dropdown
---
$$
g'(-1) = -2.
$$
::::
:::::::::::::

:::::::::::::{tab-item} c

I {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-c` vises grafen til en andregradsfunksjon $h$ og en tangent i punktet $(-1, h(-1))$. 

Bruk {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-c` til å bestemme $h'(-1)$.

:::{figure} ./figurer/oppgaver/oppgave_2/c.svg
---
name: fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-c
width: 80%
class: no-click
---
viser grafen til en andregradsfunksjon $g$ og en tangent som går gjennom $(-1, h(-1))$.
:::

::::{admonition} Fasit
---
class: answer, dropdown
---
$$
h'(-1) = 0.
$$
::::
:::::::::::::

:::::::::::::{tab-item} d

I {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-d` vises grafen til en andregradsfunksjon $p$ og en tangent i punktet $(2, p(2))$. 

Bruk {numref}`fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-d` til å bestemme $p'(2)$.

:::{figure} ./figurer/oppgaver/oppgave_2/d.svg
---
name: fig-andregradsfunksjoner-vekstfart-momentan-vekstfart-oppgave-2-d
width: 80%
class: no-click
---
viser grafen til en andregradsfunksjon $g$ og en tangent som går gjennom $(2, p(2))$.
:::

::::{admonition} Fasit
---
class: answer, dropdown
---
$$
p'(2) = 2.
$$
::::
:::::::::::::

::::::::::::::
:::::::::::::::

---

:::::::::::::::{admonition} Oppgave 3
---
class: problem-level-1
---

::::::::::::::{tab-set}
---
class: tabs-parts
---
:::::::::::::{tab-item} a
En andregradsfunksjon $f$ er gitt ved 

$$
f(x) = -x^2 + 3x.
$$

Bestem likningen for tangenten til grafen til $f$ i punktet $(1, f(1))$.


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
y = x + 1.
$$
:::
:::::::::::::

:::::::::::::{tab-item} b
En andregradsfunksjon $g$ er gitt ved 

$$
g(x) = (x + 1)^2 - 2
$$

Bestem likningen for tangenten til grafen til $g$ i punktet $(-1, g(-1))$.

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
y = -2.
$$
:::
:::::::::::::


:::::::::::::{tab-item} c
En andregradsfunksjon $h$ er gitt ved 

$$
h(x) = (x + 1)(x - 5)
$$

Bestem likningen for tangenten til grafen til $h$ i punktet $(-2, h(-2))$.


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
y = -8x - 9.
$$
:::
:::::::::::::


:::::::::::::{tab-item} d
En andregradsfunksjon $p$ er gitt ved 

$$
p(x) = -(x - 2)^2 + 1
$$

Bestem likningen for tangenten til grafen til $p$ i punktet $(-3, p(-3))$.


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
y = 10x + 6.
$$
:::
:::::::::::::

::::::::::::::



:::::::::::::::


---


:::::::::::::::{admonition} Oppgave 4
---
class: problem-level-2
---
::::::::::::::{tab-set}
---
class: tabs-parts
---
:::::::::::::{tab-item} a
Om en andregradsfunksjon $f$ får vi vite at:
* Grafen til $f$ skjærer $y$-aksen i $y = 2$.
* En tangent til grafen til $f$ i punktet $(1, f(1))$ har likningen $y = 3x - 1$.

Bestem $f(x)$. 


:::{admonition} Fasit
---
class: answer, dropdown
---
$$
f(x) = 3x^2 - 3x + 2.
$$
:::

::::{admonition} Løsning
---
class: solution, dropdown
---
Vi kan jobbe med $f(x)$ på standardform i denne oppgaven

$$
f(x) = ax^2 + bx + c,
$$

siden vi kan merke oss at vi kjenner til skjæringen med $y$-aksen som er $y = 2$. Dermed vet vi at $c = 2$. 

En tangent til grafen til $f$ går gjennom punktet $(1, f(1))$ og har likningen $y = 3x - 1$. Fra denne informasjonen kan vi hente ut to relevante biter med informasjon:

1. Den momentane vekstfarten i $x = 1$ er $f'(1) = 3$ siden dette er stigningstallet til tangenten.
2. Vi kan bestemme $f(1)$ ved å spore stegene vi ville gjort med ettpunktsformelen. 

Vi starter med å se på $f'(1)$. Vi har at 

$$
f'(1) = \dfrac{f(2) - f(0)}{2 - 0} = \dfrac{f(2) - f(0)}{2}.
$$

Vi regner ut funksjonsverdiene:

\begin{align*}
    f(2) &= 4a + 2b + 2, \\
    \\
    f(0) &= 2.
\end{align*}

Deretter setter vi inn i uttrykket for $f'(1)$:

$$
f'(1) = \dfrac{4a + 2b + 2 - 2}{2} = \dfrac{4a + 2b}{2} = 2a + b.
$$

Siden $f'(1) = 3$, får vi derfor likningen

$$
2a + b = 3.
$$

Vi trenger én likning til for å bestemme $a$ og $b$. Dette kan vi finne ved å spore stegene vi ville gjort med ettpunktsformelen fordi det lar oss bestemme hvilken verdi $f(1)$ har. Vi vet at tangenten går gjennom punktet $(x_1, y_1) = (1, f(1))$, og har stigningstall $3$ som betyr at 

\begin{align*}
y - y_1 &= 3(x - x_1) \\
\\
y - f(1) &= 3(x - 1) \\
\\
y - f(1) &= 3x - 3 \\
\\
y &= 3x + f(1) - 3 = 3x - 1.
\end{align*}

Ved å sammenligne de to uttrykkene, betyr det at 

$$
f(1) - 3 = -1 \quad \iff \quad f(1) = 2.
$$

Regner vi ut $f(1)$ med funksjonsuttrykket vårt får vi:

$$
f(1) = a + b + 2 = 2 \quad \iff \quad a + b = 0.
$$

Altså er $b = -a$ som vi kan sette inn i den første likningen:

$$
2a + b = 3 \quad \iff \quad 2a - a = 3 \quad \iff \quad a = 3 \quad \land \quad b = -3.
$$

Dermed er $f(x)$ gitt ved 

$$
f(x) = 3x^3 - 3x + 2.
$$

::::
:::::::::::::

:::::::::::::{tab-item} b
Om en andregradsfunksjon $g$ får vi vite at:
* Den momentane vekstfarten til $g$ i punktet $(-1, g(-1))$ er $0$. 
* En tangent til grafen til $g$ i punktet $(0, g(0))$ har likningen $y = 2x + 4$.

Bestem $g(x)$. 

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
g(x) = (x + 1)^2 + 3.
$$
:::

::::{admonition} Løsning
---
class: solution, dropdown
---
Siden den momentane vekstfarten til $g$ i punktet $(-1, g(-1))$ er $0$, følger det at symmetrilinja til $g$ er i $x = -1$. Dette betyr at vi kan skrive $g(x)$ på ekstremalform:

$$
g(x) = a(x + 1)^2 + y_0,
$$

der vi må bestemme $a$ og $y_0$. 

Vi vet at tangenten har stigningstall $2$ og går gjennom punktet $(0, g(0))$ som betyr at den momentane vekstfarten til $g$ i punktet er 

$$
g'(0) = 2.
$$

Vi regner ut $g'(0)$ med funksjonsuttrykket vårt som gir:

$$
g'(0) = \dfrac{g(1) - g(-1)}{2} = \dfrac{a(1 + 1)^2 + y_0 - \left(a(-1 + 1)^2 + y_0\right)}{2} = \dfrac{4a}{2} = 2a. 
$$

Dermed får vi likningen

$$
2a = 2 \quad \iff \quad a = 1.
$$

Vi trenger én likning til for å bestemme $y_0$.
Tangenten går gjennom punktet $(x_1, y_1) = (0, g(0))$. Først kan vi spore utregningene av tangenten for å avgjøre hva $g(0)$ må være. Vi vet også at tangenten har stigningstall $2$ som betyr at 

\begin{align*}
    y - y_1 &= 2(x - x_1) \\
    \\
    y - g(0) &= 2(x - 0) \\
    \\
    y &= 2x + g(0).
\end{align*}

Sammenligner vi med at likningen for tangenten er $y = 2x + 4$ betyr det at $g(0) = 4$. Regner vi ut $g(0)$ får vi

$$
g(0) = (0 - 1)^2 + y_0 = 1 + y_0.
$$

Dermed får vi likningen 

$$
1 + y_0 = 4 \quad \iff \quad y_0 = 3.
$$

Altså er $g(x)$ gitt ved

$$
g(x) = (x + 1)^2 + 3.
$$

::::
:::::::::::::

:::::::::::::{tab-item} c
Om en andregradsfunksjon $h$ får vi vite at:
* Grafen til $h$ skjærer $x$-aksen i $x = 2$. 
* En tangent til grafen til $h$ i punktet $(1, h(1))$ har likningen $y = -x + 2$. 

Bestem $h(x)$.

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
h(x) = 3\left(x - \dfrac{1}{3}\right)(x - 2).
$$
:::

::::{admonition} Løsning
---
class: solution, dropdown
---
Vi kjenner til et av nullpunktene til $h$ som betyr at å skrive $h(x)$ på nullpunktsform er hensiktsmessig:

$$
h(x) = a(x - x_1)(x - 2). 
$$

Stigningstallet til tangenten gir oss den momentane vekstfarten i $x = 1$:

$$
h'(1) = -1.
$$

I tillegg kan vi finne et uttrykk for den momentane vekstfarten med funksjonsuttrykket vårt:

$$
h'(1) = \dfrac{h(2) - h(0)}{2}.
$$

Vi regner ut funksjonsverdiene:

\begin{align*}
    h(2) &= a\cdot (2 - x_1) \cdot (2 - 2) = 0, \\
    \\
    h(0) &= a \cdot (0 - x_1) \cdot (0 - 2) = a \cdot (-x_1) \cdot (-2) = 2ax_1.
\end{align*}

Vi setter inn i uttrykket for $h'(1)$:

$$
h'(1) = \dfrac{h(2) - h(0)}{2} = \dfrac{0 - 2ax_1}{2} = -ax_1.
$$

Siden vi også vet at $h'(1) = -1$, betyr dette at vi får likningen

$$
-ax_1 = -1 \quad \iff \quad ax_1 = 1.
$$

Vi kan spore utregningen av tangenten for å bestemme verdien til $h(1)$:

\begin{align*}
    y - y_1 &= -1(x - x_1) \\
    \\
    y - h(1) &= -(x - 1) \\
    \\
    y &= -x + h(1) + 1 = -x + 2.
\end{align*}

som ved sammenligning betyr at 

$$
h(1) + 1 = 3 \quad \iff \quad h(1) = 2.
$$

Vi må også regne ut $h(1)$ med funksjonsuttrykket vårt for å sette opp en likning: 

$$
h(1) = a(1 - x_1)(1 - 2) = a(1 - x_1) = a - ax_1.
$$

Vi setter de verdiene lik hverandre som gir likningen:

$$
a - ax_1 = 2.
$$

Vi husker på at $ax_1 = 1$ som betyr at vi kan sette inn dette direkte i likningen:

$$
a - ax_1 = 2 \quad \iff \quad a - 1 = 2 \quad \iff \quad a = 3.
$$

Til slutt må vi bestemme $x_1$ som vi finner ved å bruke at $ax_1 = 1$ og $a = 3$:

$$
ax_1 = 1 \quad \iff \quad 3x_1 = 1 \quad \iff \quad x_1 = \dfrac{1}{3}.
$$

Dermed er $h(x)$ gitt ved

$$
h(x) = 3\left(x - \dfrac{1}{3}\right)(x - 2).
$$
::::
:::::::::::::


:::::::::::::{tab-item} d
Om en andregradsfunksjon $p$ får vi vite at:
* Symmetrilinja til $p$ er $x = -2$. 
* En tangent til grafen til $p$ i punktet $(-1, p(-1))$ har likningen $y = -2x + 4$.

Bestem $p(x)$.

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
p(x) = -(x + 2)^2 + 7.
$$
:::

::::{admonition} Løsning
---
class: solution, dropdown
---
Vi kjenner til at symmetrilinja til $p$ $x = -2$ som betyr at det hensiktsmessig å uttrykke $p(x)$ på ekstremalform:

$$
p(x) = a(x + 2)^2 + y_0.
$$

Tangenten i $(-1, p(-1))$ har stigningstall $-2$ som betyr at 

$$
p'(-1) = -2.
$$

Videre vil den momentane vekstfarten kunne uttrykkes som 

$$
p'(-1) = \dfrac{p(0) - p(-2)}{2}.
$$

Vi regner ut funksjonsverdiene med $p(x)$:

\begin{align*}
    p(0) &= a(0 + 2)^2 + y_0 = 4a + y_0, \\
    \\
    p(-2) &= a(-2 + 2)^2 + y_0 = y_0.
\end{align*}

Dermed får vi 

$$
p'(-1) = \dfrac{p(0) - p(-2)}{2} = \dfrac{4a + y_0 - y_0}{2} = \dfrac{4a}{2} = 2a.
$$

Altså får vi likningen

$$
p'(-1) = -2 \, \land \, p'(-1) = 2a \quad \iff \quad 2a = -2 \quad \iff \quad a = -1.
$$

Nå mangler vi bare $y_0$ som vi kan bestemme ved å spore utregningen av tangenten som går gjennom $(-1, p(-1))$:

\begin{align*}
y - y_1 &= -2(x - x_1) \\
\\
y - p(-1) &= -2(x + 1) \\
\\
y - p(-1) &= -2x - 2 \\
\\
y &= -2x + p(-1) - 2 = -2x + 4.
\end{align*}

Sammenligner vi så finner vi at 

$$
p(-1) - 2 = 4 \quad \iff \quad p(-1) = 6.
$$

Vi regner ut $p(-1)$ med $p(x)$:

$$
p(-1) = -1\cdot(-1 + 2)^2 + y_0 = -1\cdot 1 + y_0 = y_0 - 1.
$$

Dermed får vi at 

$$
p(-1) = 6 \, \land \, p(-1) = y_0 - 1 \quad \iff \quad y_0 - 1 = 6 \quad \iff \quad y_0 = 7.
$$

Dermed er $p(x)$ gitt ved

$$
p(x) = -(x + 2)^2 + 7.
$$
::::

::::::::::::::

:::::::::::::::

---


:::::::::::::::{admonition} Oppgave 5
---
class: problem-level-3
---
Lova har lest seg opp på en strategi der man kan bruke tangenter til å finne nullpunkter til en andregradsfunksjon. 

Hun har laget animasjonen under for å illustrere strategien sin.

:::{video} ./koder/animasjoner/media/videos/newtons_metode/1440p60/newtons_metode.mp4
---
width: 95%
---
:::

::::::::::::::{tab-set}
---
class: tabs-parts
---

:::::::::::::{tab-item} a
Se på animasjonen og forklar strategien til Lova.


:::{admonition} Fasit
---
class: answer, dropdown
---
Lova starter med gjetning på nullpunktet som hun kaller for $x_1$. Deretter lager hun seg en tangent som går gjennom $(x_1, f(x_1))$. Hun finner nullpunktet til denne som hun kaller for $x_2$. Så gjentar hun ved å lage en tangent gjennom $(x_2, f(x_2))$ og finner nullpunktet til denne tangenten. Slik gjentar hun flere ganger frem til hun er nærme et av nullpunktene til $f$.
:::
:::::::::::::


:::::::::::::{tab-item} b
En andregradsfunksjon $f$ er gitt ved

$$
f(x) = x^2 - 4.
$$

Bruk strategien til Lova med $x_1 = 1$ og regn ut $x_2$ og $x_3$. 

Kommer du nærme et av nullpunktene til $f$? 


:::{admonition} Fasit
---
class: answer, dropdown
---
\begin{align*}
    x_2 &= \dfrac{5}{2}\\
    \\
    x_3 &= \dfrac{41}{20} = 2.05.
\end{align*}

Et av nullpunktene til $f$ er $x = 2$, så vi kommer ganske nærme med disse to stegene.
:::
:::::::::::::


:::::::::::::{tab-item} c
Finn en generell formel for nullpunktet til en tangent som går gjennom et punkt $(x_1, y_1)$ med stigningstall a ved å ta utgangspunkt i ettpunktsformelen.

$$
y - y_1 = a(x - x_1).
$$

:::{admonition} Fasit
---
class: answer, dropdown
---
$$
x_\text{nullpunkt} = x_1 - \dfrac{y_1}{a}. 
$$
:::

:::::::::::::

:::::::::::::{tab-item} d
> Du må bruke ulike verdier for startverdien $x_1$ for å kunne finne begge nullpunktene til $f$.

Fyll ut programmet under og bruk det til å finne begge nullpunktene til $f$. 

:::{raw} html
---
file: ./python/oppgaver/newtons_metode.html
---
:::


::::{admonition} Fasit
---
class: answer, dropdown
---
:::{code-block} python
---
linenos: true
---
def f(x):
    return x**2 - 4

x1 = 1

for n in range(5): # 5 runder
    y1 = f(x1)
    a = 0.5 * (f(x1 + 1) - f(x1 - 1))
    
    x_nullpunkt = x1 - y1 / a

    # Setter x1 = x_nullpunkt og "glemmer" forrige x1
    x_nullpunkt, x1 = x1, x_nullpunkt

print(f"{x1 = :.2f}") # Skriver ut nullpunktet med 2 desimaler.
:::
::::

:::::::::::::

::::::::::::::

:::::::::::::::

